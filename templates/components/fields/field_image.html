{% macro field_image(name, label, required=False, error=None, help_text=None, current_image=None) %}
    <div class="space-y-2">
        <div>
            <label for="{{ name }}"
                   class="block text-sm font-medium text-ink dark:text-ink-inverted">
                {{ label }}
                {% if required %}<span class="text-rose-500">*</span>{% endif %}
            </label>
            <p class="text-xs text-ink-soft dark:text-ink-lighter">
                {{ help_text or "Formats acceptés : PNG, JPG, JPEG, GIF, WEBP. Max: 10Mo" }}
            </p>
        </div>
        {% if current_image %}
            <div class="flex items-center gap-3">
                <div class="h-20 w-20 overflow-hidden rounded-lg border border-primary-100 bg-surface-light shadow-lg dark:border-primary-700/60 dark:bg-surface-dark">
                    <img src="{{ url_for('static', filename=current_image) }}"
                         alt="Image actuelle"
                         class="h-full w-full object-cover" />
                </div>
                <span class="text-xs text-ink-soft dark:text-ink-lighter">
                    Une image est déjà associée à cette recette. Vous pouvez en sélectionner une nouvelle pour la remplacer.
                </span>
            </div>
        {% endif %}
        <input type="file"
               id="{{ name }}"
               name="{{ name }}"
               accept="image/*"
               class="block w-full text-sm text-ink file:mr-3 file:rounded-lg file:border file:border-primary-100 file:bg-surface-light file:px-3 file:py-2 file:text-xs file:font-medium file:text-ink-soft hover:file:border-primary-300 hover:file:text-primary-700 dark:file:border-primary-700/60 dark:file:bg-surface-dark dark:file:text-ink-lighter dark:hover:file:border-primary-500 dark:hover:file:text-primary-50"
               {{ "required" if required }}
               data-max-size="10485760" />
        {% if error %}<p class="text-xs text-rose-600 dark:text-rose-400">{{ error }}</p>{% endif %}
    </div>
{% endmacro %}
